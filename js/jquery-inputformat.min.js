/*! jquery-inputformat 30-12-2014 */
String.prototype.endsWith||Object.defineProperty(String.prototype,"endsWith",{value:function(a,b){var c=this.toString();(void 0===b||b>c.length)&&(b=c.length),b-=a.length;var d=c.indexOf(a,b);return-1!==d&&d===b}}),$.inputformat={defaultOptions:{thousandSep:",",decimalSep:".",allowDecimals:!0,allowNegative:!0,allowLeadingZero:!1,maxDecimalDigits:"unlimited"},getOptions:function(a){return JSON.parse($(a).attr("input-format"))},getThousandSep:function(a){return this.getOptions(a).thousandSep},getDecimalSep:function(a){return this.getOptions(a).decimalSep},getMaxDecimalDigits:function(a){return this.getOptions(a).maxDecimalDigits},isAllowDecimals:function(a){return this.getOptions(a).allowDecimals},isAllowNegative:function(a){return this.getOptions(a).allowNegative},isAllowLeadingZero:function(a){return this.getOptions(a).allowLeadingZero},getSelectionText:function(){var a="";return window.getSelection?a=window.getSelection().toString():document.selection&&"Control"!=document.selection.type&&(a=document.selection.createRange().text),a},setCaretPosition:function(a,b){if(a.setSelectionRange)a.focus(),a.setSelectionRange(b,b);else if(a.createTextRange){var c=a.createTextRange();c.collapse(!0),c.moveEnd("character",b),c.moveStart("character",b),c.select()}},getCaretPosition:function(a){var b=0;if(document.selection){a.focus();var c=document.selection.createRange();c.moveStart("character",-a.value.length),b=c.text.length}else(a.selectionStart||"0"==a.selectionStart)&&(b=a.selectionStart);return b},replaceAll:function(a,b,c){return c.replace(new RegExp(a,"g"),b)},unformat:function(a,b){var c="",d="",e="",f=$.inputformat.getThousandSep(a),g=$.inputformat.getDecimalSep(a),h=$.inputformat.isAllowLeadingZero(a);if("0"==b)return"0";var i=b.indexOf(g);if(-1==i?c=b:(c=b.substring(0,i),d=i<b.length-1?b.substring(i+1):""),c=$.inputformat.replaceAll(f,"",c.toString()),e=""!==d?c+g+d:c,!h)for(;"0"==e.charAt(0);)e=e.substring(1);return e},format:function(a,b){var c="0"==b?0:$.inputformat.unformat(a,b),d="",e="",f=$.inputformat.getThousandSep(a),g=$.inputformat.getDecimalSep(a),h=c.indexOf(g);-1==h?d=c:(d=c.substring(0,h),e=h<=c.length-1?c.substring(h+1):"");var i=d.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+f);return-1!=h&&""!==e&&(i=i+g+e),i}},$.fn.inputNumber=function(a){if(void 0!==a){if(void 0===a.thousandSep&&(a.thousandSep=$.inputformat.defaultOptions.thousandSep),void 0===a.decimalSep&&(a.decimalSep=$.inputformat.defaultOptions.decimalSep),void 0!==a.maxDecimalDigits){if("unlimited"!=a.maxDecimalDigits&&isNaN(a.maxDecimalDigits))throw"maxDecimalDigits must a number or 'unlimited'"}else a.maxDecimalDigits=$.inputformat.defaultOptions.maxDecimalDigits;if(void 0!==a.allowDecimals){if(a.allowDecimals!==!0&&a.allowDecimals!==!1)throw"allowDecimals must boolean"}else a.allowDecimals=$.inputformat.defaultOptions.allowDecimals;if(void 0!==a.allowNegative){if(a.allowNegative!==!0&&a.allowNegative!==!1)throw"allowNegative must boolean"}else a.allowNegative=$.inputformat.defaultOptions.allowNegative;if(void 0!==a.allowLeadingZero){if(a.allowLeadingZero!==!0&&a.allowLeadingZero!==!1)throw"allowNegative must boolean"}else a.allowLeadingZero=$.inputformat.defaultOptions.allowLeadingZero;if(void 0!==a.numericOnly){if(a.numericOnly!==!0&&a.numericOnly!==!1)throw"numericOnly must boolean";a.numericOnly===!0&&(a.allowDecimals=!1,a.allowNegative=!1,a.thousandSep="")}}else a=$.inputformat.defaultOptions;$(this).attr("input-format",JSON.stringify(a)),$(this).on("paste",function(){var a=this;setTimeout(function(){var b=$.inputformat.unformat(a,a.value);$(a).val(isNaN(b)?$.inputformat.oldValue:$.inputformat.format(a,b))},0)}),$(this).keyup(function(a){var b=$.inputformat.getCaretPosition(this),c=this,d=$(c).val();if(a.ctrlKey)switch(a.keyCode){case 65:case 67:case 88:case 86:return}switch(a.keyCode){case 16:case 17:case 36:case 35:case 37:case 39:break;case 96:case 97:case 98:case 99:case 100:case 101:case 102:case 103:case 104:case 105:case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:case 8:case 46:case 189:setTimeout(function(){var a=$.inputformat.format(c,d),e=a.length-d.length;$(c).val(a),$.inputformat.setCaretPosition(c,b+e)},0)}}),$(this).keydown(function(a){var b=$.inputformat.getCaretPosition(this),c=$(this).val(),d=$.inputformat.getThousandSep(this),e=$.inputformat.getDecimalSep(this),f=$.inputformat.getMaxDecimalDigits(this),g=$.inputformat.isAllowLeadingZero(this);if($.inputformat.oldValue=c,a.ctrlKey)switch(a.keyCode){case 65:case 67:break;case 88:a.preventDefault();break;case 86:a.preventDefault();break;default:a.preventDefault()}else switch(a.keyCode){case 96:case 48:if(g||$.inputformat.getSelectionText()==c||(0===b&&""!==c?a.preventDefault():1==b&&"0"===c&&a.preventDefault()),"unlimited"==f)break;var h=c.lastIndexOf(e);-1!=h&&b>h&&c.length-h==f+1&&a.preventDefault();break;case 97:case 98:case 99:case 100:case 101:case 102:case 103:case 104:case 105:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:if(0===b&&0===c.indexOf("-")&&a.preventDefault(),g||1==b&&"0"===c&&a.preventDefault(),"unlimited"==f)break;var i=c.lastIndexOf(e);-1!=i&&b>i&&c.length-i==f+1&&a.preventDefault();break;case 36:case 9:case 8:c.substr(b-1,1)==d&&(c=c.substr(0,b)+c.substr(b),$(this).val(c));break;case 46:case 35:case 37:case 39:break;case 110:case 190:$.inputformat.isAllowDecimals(this)!==!0&&a.preventDefault(),-1!=c.indexOf(e)&&a.preventDefault(),b<c.length&&a.preventDefault();break;case 109:case 189:$.inputformat.isAllowNegative(this)!==!0&&a.preventDefault(),b>0?a.preventDefault():0===c.indexOf("-")&&a.preventDefault();break;default:a.preventDefault()}})};